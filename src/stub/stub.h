#pragma once

#include <Windows.h>
#include <cstdint>
typedef struct _GlobalParam {
	uint64_t OEP;
	uint64_t importHeaderRva;
	uint64_t RelocHeaderRva;
	uint64_t imageBase;
	uint64_t startAddr;
}GlobalParam,* PGlobalParam;


extern "C" {
	extern __declspec(dllexport) GlobalParam globalParam;
}

void fixIAT();
void fixReloc();


#ifdef _WIN64
#define OBFUSBYTE  0xEB, 0x01, 0xA0, 0x48, 0x83, 0xEC, 0x20, 0x9C, \
	0xEB, 0x01, 0xA0, 0x54, 0x50, 0xE8, 0x01, 0x00,\
	0x00, 0x00, 0xA0, 0x58, 0xEB, 0x01, 0xA0, 0x48,\
	0x83, 0xC0, 0x26, 0xEB, 0x01, 0xA0, 0x54, 0x50,\
	0xEB, 0x01, 0xA0, 0x48, 0x83, 0xF0, 0x12, 0xEB,\
	0x01, 0xA0, 0x48, 0x83, 0xF0, 0x12, 0xEB, 0x01,\
	0xA0, 0x50, 0xEB, 0x01, 0xA0, 0xC2, 0x10, 0x00,\
	0x58, 0x5C, 0xEB, 0x01, 0xA0, 0x9D, 0xEB, 0x01,\
	0x00, 0x48, 0x83, 0xC4, 0x20, 0xEB, 0x01, 0xE8,\
	0x90
#else
//»¨Ö¸Áî´úÂë
#define OBFUSBYTE 0xEB, 0x01, 0xA0, 0x83, 0xEC, 0x20, 0x9C, 0xEB,\
	0x01, 0xA0, 0x60, 0xE8, 0x01, 0x00, 0x00, 0x00,\
	0xA0, 0x58, 0xEB, 0x01, 0xA0, 0x83, 0xC0, 0x22,\
	0xEB, 0x01, 0xA0, 0x60, 0xEB, 0x01, 0xA0, 0x83,\
	0xF0, 0x12, 0xEB, 0x01, 0xA0, 0x83, 0xF0, 0x12,\
	0xEB, 0x01, 0xA0, 0x50, 0xEB, 0x01, 0xA0, 0xC2,\
	0x20, 0x00, 0x61, 0xEB, 0x01, 0xA0, 0x9D, 0xEB,\
	0x01, 0xA0, 0x83, 0xC4, 0x20, 0xEB, 0x01, 0xE8,\
	0x90  
#endif